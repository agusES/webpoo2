<!DOCTYPE html>
<html lang="#{idioma.language}" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
      xmlns:of="http://omnifaces.org/functions">

    <h:head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <link rel="stylesheet" href="css/tema.css" />

        <link rel="stylesheet"
              href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" />
        <link rel="stylesheet"
              href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" />

        <script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
        <script
        src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

        <title>#{msg['Activity']}</title>
    </h:head>

    <body>

        <f:view locale="#{idioma.locale}">
            <nav class="navbar navbar-expand navbar-light">
                <ul class="navbar-nav" id="barra-izq">
                    <h:form>
                        <h:commandButton action="#{usuarioController.inicio()}"
                                         value="#{msg['Home']}" class="btn btn-link" />
                    </h:form>
                    <h:form>
                        <h:commandButton
                            action="inicioActivity.xhtml?faces-redirect=true"
                            value="#{msg['Activity']}" class="btn btn-link" />
                    </h:form>
                    <h:form>
                        <h:commandButton action="inicioOds.xhtml?faces-redirect=true"
                                         value="#{msg['Objectives']}" class="btn btn-link" />
                    </h:form>
                </ul>

                <ul class="navbar-nav ml-auto" id="barra-der">
                    <button type="button" data-toggle="modal"
                            data-target="#infoModal" class="btn btn-link">#{msg['About']}</button>
                    <h:form>
                        <h:commandButton action="#"
                                         value="#{usuarioController.getUserName()}"
                                         class="btn btn-link" />
                    </h:form>
                    <h:form>
                        <h:commandButton action="#{usuarioController.logout()}"
                                         value="#{msg['Logout']}" class="btn btn-link" />
                    </h:form>
                    <h:form>
                        <h:selectOneMenu value="#{idioma.language}"
                                         onchange="submit()" class="cambiar-idioma">
                            <f:selectItem itemValue="es" itemLabel="EspaÃ±ol" />
                            <f:selectItem itemValue="en" itemLabel="English" />
                            <f:selectItem itemValue="fr" itemLabel="Francais" />
                        </h:selectOneMenu>
                    </h:form>
                </ul>
            </nav>

            <div class="container-activities">

                <h:form>
                    <p:dataTable class="table-activities" id="activities"
                                 value="#{actividadController.getActividades()}"
                                 var="actividad" scrollable="false" editable="true">

                        <f:facet name="header">#{msg['ActivityList']}</f:facet>

                        <p:column headerText="#{msg['Name']}" style="width: 17.5%;">
                            #{actividad.nombre}</p:column>

                        <p:column headerText="#{msg['Tipo']}" style="width: 2.5%;">
                            #{actividad.tipo()} </p:column>

                        <p:column headerText="#{msg['StartDate']}" style="width: 5%;">
                            #{actividad.fechaInicio}</p:column>

                        <p:column headerText="#{msg['EndDate']}" style="width: 5%;" >
                            #{actividad.fechaFin}</p:column>

                        <p:column headerText="#{msg['Resolution']}" style="width: 5%;">
                            #{actividad.resolucion}</p:column>

                        <p:column headerText="#{msg['CaseFile']}" style="width: 5%;">
                            #{actividad.expediente}</p:column>

                        <p:column headerText="#{msg['Announcement']}" style="width: 10%;">
                            #{actividad.convocatoria}</p:column>

                        <p:column headerText="#{msg['StrategicLine']}" style="width: 12.5%;">
                            #{actividad.linea}</p:column>

                        <p:column headerText="#{msg['Ambit']}" style="width: 7.5%;">
                            #{actividad.ambito}</p:column>

                        <p:column headerText="#{msg['Impacto']}" style="width: 20%;">
                            #{actividad.impactos}</p:column>

                        <p:column headerText="#{msg['Responsables']}" style="width: 10%;">
                            #{actividad.responsablesToString()}</p:column>

                    </p:dataTable>
                </h:form>

                <div class="form-activity">

                    <p:tabView>

                        <p:tab title="#{msg['AddSimpleActivity']}">
                            <h:form id="add-simple-activity">
                                <table id="form-simple">
                                    <tr class="columna">
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="activity-name">#{msg['Name']}</label>
                                            <h:inputText id="activity-name"
                                                         value="#{actividadSimpleController.name}"
                                                         required="true" /></td>

                                        <td><label for="fecha-inicio">#{msg['StartDate']}</label>
                                            <p:calendar id="fecha-inicio"
                                                        value="#{actividadSimpleController.startDate}"
                                                        mode="popup" showOn="focus" locale="es" /></td>

                                        <td><label for="fecha-final">#{msg['EndDate']}</label>
                                            <p:calendar id="fecha-final"
                                                        value="#{actividadSimpleController.endDate}"
                                                        mode="popup" showOn="focus" locale="es" /></td>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="resolucion">#{msg['Resolution']}</label>
                                            <h:inputText id="resolucion"
                                                         value="#{actividadSimpleController.resolucion}"
                                                         required="true" /></td>

                                        <td><label for="expediente">#{msg['CaseFile']}</label>
                                            <h:inputText id="expediente"
                                                         value="#{actividadSimpleController.expediente}"
                                                         required="true" /></td>

                                        <td><label for="convocatoria">#{msg['Announcement']}</label>
                                            <p:selectOneMenu id="convocatoria"
                                                             value="#{actividadSimpleController.convocatoria}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems
                                                    value="#{convocatoriaController.getConvocatorias()}"
                                                    var="convocatoria"
                                                    itemLabel="#{convocatoria.nombre}"
                                                    itemValue="#{convocatoria}" />
                                            </p:selectOneMenu></td>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="linea-estrategica">#{msg['StrategicLine']}</label>
                                            <p:selectOneMenu id="linea-estrategica"
                                                             value="#{actividadSimpleController.linea}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems
                                                    value="#{lineaEstrategicaController.getLineas()}"
                                                    var="linea" itemLabel="#{linea.nombre}"
                                                    itemValue="#{linea}" />
                                            </p:selectOneMenu></td>

                                        <td><label for="ambito">#{msg['Ambit']}</label> <p:selectOneMenu
                                                id="ambito"
                                                value="#{actividadSimpleController.ambito}"
                                                converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems
                                                    value="#{ambitoController.getAmbitos()}"
                                                    var="ambito" itemLabel="#{ambito.nombre}"
                                                    itemValue="#{ambito}" />
                                            </p:selectOneMenu></td>

                                    </tr>
                                </table>

                                <hr />

                                <table id="form-simple2">
                                    <tr class="columna">
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>

                                    <tr class="columna">

                                        <td><label for="impacto">#{msg['ObjetivoAfectado']}</label> <p:selectOneMenu id="impacto"
                                                                                                                     value="#{actividadSimpleController.objetivoSeleccionado}"
                                                                                                                     converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems
                                                    value="#{objetivoController.getObjetivos()}"
                                                    var="objetivo" itemLabel="#{objetivo.nombre}"
                                                    itemValue="#{objetivo}" />
                                            </p:selectOneMenu></td>

                                        <td><label for="peso">#{msg['Impacto']}</label> <h:inputText
                                                id="peso"
                                                value="#{actividadSimpleController.peso}"
                                                required="true" /></td>

                                        <td></td>

                                    </tr>
                                </table>

                                <hr />

                                <h:commandButton class="btn btn-secondary"
                                                 action="#{actividadSimpleController.create()}"
                                                 value="#{msg['Create']}" />

                            </h:form>
                        </p:tab>

                        <p:tab title="#{msg['AnhadirImpacto']}">
                            <h:form id="anhadir-impacto">

                                <table id="form-simple">
                                    <tr class="columna">
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>

                                    <tr class="columna" layout="responsive" columns="3">
                                        <td><label for="actividad-que-impacta">#{msg['SeleccionarActividad']}</label>
                                            <p:selectOneMenu id="actividad-que-impacta" value="#{actividadSimpleController.actividadSeleccionada}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems value="#{actividadSimpleController.getActividadesSimples()}" var="actividad"
                                                               itemLabel="#{actividad.nombre}" itemValue="#{actividad}" />
                                            </p:selectOneMenu>
                                        </td>

                                        <td><label for="objetivo-afectado">#{msg['ObjetivoAfectado']}</label>
                                            <p:selectOneMenu id="objetivo-afectado" value="#{actividadSimpleController.objetivoSeleccionado}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems value="#{objetivoController.getObjetivos()}" var="objetivo"
                                                               itemLabel="#{objetivo.nombre}" itemValue="#{objetivo}" />
                                            </p:selectOneMenu>
                                        </td>

                                        <td><label for="peso">#{msg['Impacto']}</label>
                                            <h:inputText id="peso" value="#{actividadSimpleController.peso}" required="true" />
                                        </td>
                                    </tr>

                                </table>

                                <hr />

                                <h:commandButton class="btn btn-secondary" action="#{actividadSimpleController.addImpacto()}"
                                                 value="#{msg['Asignar']}" />

                            </h:form>
                        </p:tab>

                        <p:tab title="#{msg['AddCompoundActivity']}">
                            <h:form id="add-compound-activity">
                                <table >
                                    <tr class="columna">
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="activity-name">#{msg['Name']}</label>
                                            <h:inputText id="activity-name"
                                                         value="#{compuestoController.name}"
                                                         required="true" /></td>

                                        <td><label for="fecha-inicio">#{msg['StartDate']}</label>
                                            <p:calendar id="fecha-inicio"
                                                        value="#{compuestoController.startDate}"
                                                        mode="popup" showOn="focus" locale="es" /></td>

                                        <td><label for="fecha-final">#{msg['EndDate']}</label>
                                            <p:calendar id="fecha-final"
                                                        value="#{compuestoController.endDate}"
                                                        mode="popup" showOn="focus" locale="es" /></td>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="resolucion">#{msg['Resolution']}</label>
                                            <h:inputText id="resolucion"
                                                         value="#{compuestoController.resolucion}"
                                                         required="true" /></td>

                                        <td><label for="expediente">#{msg['CaseFile']}</label>
                                            <h:inputText id="expediente"
                                                         value="#{compuestoController.expediente}"
                                                         required="true" /></td>

                                        <td><label for="convocatoria">#{msg['Announcement']}</label>
                                            <p:selectOneMenu id="convocatoria"
                                                             value="#{compuestoController.convocatoria}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems
                                                    value="#{convocatoriaController.getConvocatorias()}"
                                                    var="convocatoria"
                                                    itemLabel="#{convocatoria.nombre}"
                                                    itemValue="#{convocatoria}" />
                                            </p:selectOneMenu></td>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="linea-estrategica">#{msg['StrategicLine']}</label>
                                            <p:selectOneMenu id="linea-estrategica"
                                                             value="#{compuestoController.linea}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true" />
                                                <f:selectItems
                                                    value="#{lineaEstrategicaController.getLineas()}"
                                                    var="linea" itemLabel="#{linea.nombre}"
                                                    itemValue="#{linea}" />
                                            </p:selectOneMenu></td>

                                        <td><label for="ambito">#{msg['Ambit']}</label> <p:selectOneMenu
                                                id="ambito"
                                                value="#{compuestoController.ambito}"
                                                converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="#{msg['Seleccionar']}" itemValue="" itemDisabled="true"/>
                                                <f:selectItems
                                                    value="#{ambitoController.getAmbitos()}"
                                                    var="ambito" itemLabel="#{ambito.nombre}"
                                                    itemValue="#{ambito}" />
                                            </p:selectOneMenu></td>

                                    </tr>
                                </table>                        

                                <hr />

                                <table id="form-simple">
                                    <tr class="columna">
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>

                                    <tr class="columna">

                                        <td><label for="impacto">#{msg['SeleccionarActividad']}
                                            </label> <p:selectManyCheckbox id="actividades" layout="responsive" columns="4"
                                                                           value="#{compuestoController.actividades}"
                                                                           converter="omnifaces.SelectItemsConverter">
                                                <f:selectItems
                                                    value="#{actividadController.getActividades()}"
                                                    var="actividad" itemLabel="#{actividad.nombre}"
                                                    itemValue="#{actividad}" />
                                            </p:selectManyCheckbox></td>
                                    </tr>
                                </table>

                                <hr />

                                <h:commandButton class="btn btn-secondary"
                                                 action="#{compuestoController.create()}"
                                                 value="#{msg['Create']}" />


                            </h:form>
                        </p:tab>

                        <p:tab title="#{msg['AssignActivity']}">
                            <h:form id="assign-activity">

                                <table id="form-simple">
                                    <tr class="columna">
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>

                                    <tr class="columna">
                                        <td><label for="lista-objetivos">#{msg['SeleccionarActividad']}</label> <p:selectOneMenu id="lista-objetivos"
                                                                                                                                 value="#{actividadController.actividadSeleccionada}"
                                                                                                                                 converter="omnifaces.SelectItemsConverter">
                                                <f:selectItems
                                                    value="#{actividadController.getActividades()}"
                                                    var="actividad" itemLabel="#{actividad.nombre}"
                                                    itemValue="#{actividad}" />
                                            </p:selectOneMenu></td>

                                        <td><label for="lista-usuarios">#{msg['SeleccionarUsuario']}</label> <p:selectOneMenu id="lista-usuarios"
                                                                                                                              value="#{actividadController.usuarioResponsable}"
                                                                                                                              converter="omnifaces.SelectItemsConverter">
                                                <f:selectItems
                                                    value="#{usuarioController.getUsers()}"
                                                    var="usuario" itemLabel="#{usuario.name}"
                                                    itemValue="#{usuario}" />
                                            </p:selectOneMenu></td>

                                        <td></td>
                                    </tr>

                                </table>
                                <hr />

                                <h:commandButton class="btn btn-secondary"
                                                 action="#{actividadController.addUsuario()}"
                                                 value="#{msg['Asignar']}" />

                            </h:form>
                        </p:tab>                                        

                        <p:tab title="#{msg['CrearConvocatoria']}">
                            <h:form id="crear-convo">
                                <label for="convo-name">#{msg['Name']}</label>
                                <h:inputText id="convo-name"
                                             value="#{convocatoriaController.nombre}" required="true" />

                                <hr />

                                <h:commandButton
                                    class="btn btn-secondary"
                                    action="#{convocatoriaController.crear()}"
                                    value="#{msg['Create']}" />
                            </h:form>
                        </p:tab>

                        <p:tab title="#{msg['CrearLineaEstrategica']}">
                            <h:form id="crear-linea">
                                <label for="linea-name">#{msg['Name']}</label>
                                <h:inputText id="linea-name"
                                             value="#{lineaEstrategicaController.nombre}"
                                             required="true" />

                                <hr />

                                <h:commandButton
                                    class="btn btn-secondary"
                                    action="#{lineaEstrategicaController.crear()}"
                                    value="#{msg['Create']}" />
                            </h:form>
                        </p:tab>

                        <p:tab title="#{msg['CrearAmbito']}">
                            <h:form id="crear-ambito">
                                <label for="ambito-name">#{msg['Name']}</label>
                                <h:inputText id="ambito-name"
                                             value="#{ambitoController.nombre}" required="true" />

                                <hr />

                                <h:commandButton 
                                    class="btn btn-secondary"
                                    action="#{ambitoController.crear()}"
                                    value="#{msg['Create']}" />
                            </h:form>
                        </p:tab>

                    </p:tabView>
                </div>
            </div>

            <div class="footer">
                #{msg['CreatedBy']}<a href="https://www.unnoba.edu.ar/">UNNOBA</a>
            </div>

            <div class="modal fade" id="infoModal" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-tittle">#{msg['About']}</h3>
                            <button type="button" class="close" data-dismiss="modal"
                                    aria-label="Close">
                                <span aria-hidden="true">&#215;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <p style="text-align: justify">
                                <span>#{msg['AboutUs']}</span>
                            </p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary"
                                    data-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            </div>
        </f:view>

    </body>
</html>